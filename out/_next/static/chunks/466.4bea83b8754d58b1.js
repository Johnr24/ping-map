(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[466],{8466:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r(7437),o=r(2265),c=r(7748),l=r.n(c);function a(e){return Math.PI/180*e}function i(e,t,r,n){let o=a(r-e),c=a(n-t),l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(a(e))*Math.cos(a(r))*Math.sin(c/2)*Math.sin(c/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371}function u(){let e=(0,o.useRef)(null),t=(0,o.useRef)(null),r=(0,o.useRef)([]),c=(0,o.useRef)([]),[a,u]=(0,o.useState)("N/A"),s=(0,o.useRef)(0);(0,o.useEffect)(()=>{if(!t.current)return e.current&&(t.current=new(l()).Map({container:e.current,style:{version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"\xa9 OpenStreetMap contributors"}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:19}]},center:[0,0],zoom:1,pitch:0,bearing:0}),e.current.style.background="#000",t.current.addControl(new(l()).NavigationControl),t.current.addControl(new(l()).AttributionControl({customAttribution:"\xa9 OpenStreetMap contributors"}),"bottom-right"),t.current.on("click",e=>{console.log("Map clicked at:",e.lngLat);let{lng:t,lat:r}=e.lngLat;console.log("Adding marker at: lng=".concat(t,", lat=").concat(r)),d(t,r)}),t.current.on("load",()=>{var e;console.log("Map loaded"),null===(e=t.current)||void 0===e||e.setProjection({type:"globe"}),console.log("Globe projection set")}),t.current.on("style.load",()=>{console.log("Map style loaded")})),()=>{r.current.forEach(e=>e.remove()),t.current&&(t.current.remove(),t.current=null)}},[]);let d=(e,n)=>{if(!t.current)return;if(console.log("Adding marker at:",[e,n]),r.current.length>=2){let e=r.current.shift();null==e||e.remove(),c.current.shift()}s.current+=1;let o=s.current%2==1?"#ff3b30":"#007aff",a=document.createElement("div");a.className="marker",a.style.backgroundColor=o,console.log("Adding ".concat("#ff3b30"===o?"red":"blue"," marker, count: ").concat(s.current));let i=new(l()).Marker({element:a,anchor:"center"}).setLngLat([e,n]).addTo(t.current);if(r.current.push(i),c.current.push([n,e]),console.log("Current markers count:",r.current.length),console.log("Current points:",c.current),2===r.current.length)console.log("We have 2 markers, drawing line and calculating ping"),g(c.current);else if(t.current.getSource("route"))try{t.current.removeLayer("route-line"),t.current.removeLayer("route-glow"),t.current.removeSource("route")}catch(e){console.error("Error removing existing layers:",e)}},g=e=>{if(!t.current||2!==e.length)return;let[r,n]=e[0],[o,c]=e[1];console.log("Calculating ping time between:","Point 1: ".concat(r,", ").concat(n),"Point 2: ".concat(o,", ").concat(c));let a=i(r,n,o,c)/(299792.458*.68)*2e3,s=i(r,n,o,c);console.log("Calculated values:",{time:a,distance:s});let d=a<1?"".concat((1e3*a).toFixed(2)," Î¼s"):a<1e3?"".concat(a.toFixed(2)," ms"):"".concat((a/1e3).toFixed(2)," s");if(u(d),t.current.getSource("route"))try{t.current.removeLayer("route-line"),t.current.removeLayer("route-glow"),t.current.removeSource("route")}catch(e){console.error("Error removing existing layers:",e)}t.current.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[[n,r],[c,o]]}}}),console.log("Added route source with coordinates:",[[n,r],[c,o]]),t.current.addLayer({id:"route-glow",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#4db8ff","line-width":15,"line-opacity":.8,"line-blur":15}}),console.log("Added glow layer"),t.current.addLayer({id:"route-line",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#ffffff","line-width":5,"line-opacity":1,"line-dasharray":[.5,1]}}),console.log("Added line layer");let g=(r+o)/2,p=(n+c)/2;Array.from(document.getElementsByClassName("ping-popup")).forEach(e=>e.remove()),new(l()).Popup({closeButton:!1,closeOnClick:!1,className:"ping-popup",anchor:"center"}).setLngLat([p,g]).setHTML('\n        <div class="text-center p-2">\n          <div class="font-bold text-lg text-blue-400">'.concat(d,'</div>\n          <div class="text-sm">Distance: ').concat(s.toFixed(0)," km</div>\n        </div>\n      ")).addTo(t.current),console.log("Added popup with ping time:",d)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"instructions absolute top-4 left-4 z-10 bg-black/70 p-4 rounded-lg text-white max-w-md",children:[(0,n.jsx)("h3",{className:"text-xl font-bold mb-2",children:"Instructions:"}),(0,n.jsx)("p",{children:"Click on two different locations on the globe to calculate the theoretical minimum ping time between them."}),(0,n.jsxs)("div",{className:"mt-4 p-2 bg-gray-800 rounded",children:[(0,n.jsx)("span",{children:"Theoretical Minimum Ping Time: "}),(0,n.jsx)("span",{className:"font-bold text-xl text-blue-400",children:a})]})]}),(0,n.jsx)("div",{ref:e,className:"map-container",style:{width:"100%",height:"100vh"}})]})}r(1322)},1322:function(){}}]);